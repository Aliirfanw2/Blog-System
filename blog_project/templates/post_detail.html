{% extends 'base.html' %}
{% load static %}

{% block extra_head %}

  <meta name="description" content="{{ meta_description }}">
    <meta name="keywords" content="{{ meta_keywords|default:'' }}">
    <title>{{ post.title|default:'ApnaBlog' }} | ApnaBlog</title>
{% endblock %}


{% block content %}
<link rel="stylesheet" href="{% static 'css/post_hover.css' %}">

<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-lg-8">
      <div class="card shadow-lg border-0 mb-5" style="background: #f8f9fa;">
        <div class="card-body p-5 post-view-section">
          <!-- Large Cover Image -->
          <div class="mb-4 text-center">
            {% if post.image %}
              <img src="{{ post.image.url }}" class="img-fluid rounded-3 shadow" style="max-width:400px;max-height:300px;object-fit:cover;" alt="Post Image">
            {% else %}
              <img src="{% static 'img/default_post.png' %}" class="img-fluid rounded-3 shadow" style="max-width:400px;max-height:300px;object-fit:cover;" alt="No Image Available">
            {% endif %}
          </div>
          <!-- Minimal Header -->
          <header class="mb-4 text-center">
            <h1 class="display-4 fw-bold" style="letter-spacing:1px; font-family: 'Merriweather', serif;">{{ post.title }}</h1>
            <div class="text-muted small mt-2">
              By <span class="fw-bold">{{ post.author.username }}</span> &bull; {{ post.created_at|date:"M d, Y" }}
            </div>
            <div class="mt-2">
              <span class="badge bg-secondary">{{ post.status|title }}</span>
              {% if post.tags.all %}
                {% for tag in post.tags.all %}
                  <span class="badge bg-info text-dark me-1">{{ tag.name }}</span>
                {% endfor %}
              {% endif %}
            </div>
          </header>
          <!-- Article Content -->
          <article class="mb-5" style="font-size:1.15rem; line-height:1.8; font-family: 'Merriweather', serif; color:#222;">
            {{ post.content|linebreaks }}
          </article>
          <!-- Like & Share Section -->
          <div class="d-flex flex-wrap align-items-center gap-3 mb-4">
            <form method="post" action="{% url 'like_post' post.id %}">
              {% csrf_token %}
              <button type="submit" class="btn btn-danger rounded-pill px-3 shadow-sm">
                <i class="bi bi-heart-fill me-1"></i> Like {% if post.likes_count %}({{ post.likes_count }}){% endif %}
              </button>
            </form>
            <span class="fw-bold">Comments:</span>
            <span class="badge bg-primary rounded-pill">{{ post.comments.count }}</span>
          </div>
          <div class="d-flex align-items-center gap-2 mb-5 justify-content-start">
            <span class="fw-bold">Share:</span>
            <a href="https://www.facebook.com/sharer/sharer.php?u={{ request.build_absolute_uri }}" target="_blank" class="btn btn-sm btn-primary rounded-circle me-1" title="Share on Facebook">
              <!-- Official Facebook SVG Logo -->
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 32 32" fill="white"><path d="M29 0H3C1.343 0 0 1.343 0 3v26c0 1.657 1.343 3 3 3h13V20h-4v-5h4v-3.5C16 8.57 18.57 6 22.5 6c1.104 0 2 .896 2 2v3h-2c-.553 0-1 .447-1 1v3h4l-1 5h-3v12h5c1.657 0 3-1.343 3-3V3c0-1.657-1.343-3-3-3z"/></svg>
            </a>
            <a href="https://twitter.com/intent/tweet?url={{ request.build_absolute_uri }}" target="_blank" class="btn btn-sm btn-info rounded-circle me-1" title="Share on Twitter">
              <!-- Official Twitter SVG Logo -->
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 32 32" fill="white"><path d="M32 6.076a13.14 13.14 0 0 1-3.769 1.031A6.601 6.601 0 0 0 31.115 4.1a13.19 13.19 0 0 1-4.169 1.594A6.563 6.563 0 0 0 22.155 2c-3.626 0-6.563 2.938-6.563 6.563 0 .514.058 1.016.17 1.496C10.272 9.87 5.444 7.613 2.228 4.149a6.52 6.52 0 0 0-.888 3.301c0 2.277 1.159 4.287 2.924 5.463A6.533 6.533 0 0 1 1.28 11.1v.083c0 3.181 2.263 5.834 5.267 6.437a6.575 6.575 0 0 1-2.892.11c.816 2.548 3.184 4.402 5.987 4.45A13.172 13.172 0 0 1 0 28.013a18.575 18.575 0 0 0 10.063 2.949c12.072 0 18.684-10.004 18.684-18.684 0-.285-.007-.568-.02-.85A13.348 13.348 0 0 0 32 6.076z"/></svg>
            </a>
            <a href="https://wa.me/?text={{ request.build_absolute_uri }}" target="_blank" class="btn btn-sm btn-success rounded-circle" title="Share on WhatsApp" style="background:#25D366;border:none;">
              <!-- Official WhatsApp SVG Logo -->
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="white" viewBox="0 0 32 32"><path d="M16 3C9.373 3 4 8.373 4 15c0 2.385.668 4.661 1.934 6.661L4 29l7.661-1.934A12.96 12.96 0 0 0 16 27c6.627 0 12-5.373 12-12S22.627 3 16 3zm0 22c-1.982 0-3.918-.521-5.604-1.507l-.401-.232-4.543 1.148 1.211-4.429-.26-.418A10.96 10.96 0 0 1 6 15c0-5.514 4.486-10 10-10s10 4.486 10 10-4.486 10-10 10zm5.297-7.255c-.297-.149-1.757-.867-2.028-.967-.271-.099-.469-.148-.667.15-.198.297-.767.967-.94 1.166-.173.198-.347.223-.644.074-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.447-.52.149-.174.198-.298.298-.497.099-.198.05-.372-.025-.521-.075-.149-.667-1.611-.914-2.205-.241-.579-.487-.5-.667-.51-.173-.007-.372-.009-.571-.009-.198 0-.52.074-.793.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.877 1.213 3.075.149.198 2.099 3.209 5.088 4.377.712.306 1.267.489 1.701.625.715.228 1.366.196 1.88.119.574-.085 1.757-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347z"/></svg>
            </a>
          </div>
          <!-- Comments Section -->
          <section class="mb-4">
            <h5 class="fw-bold mb-3"><i class="bi bi-chat-dots me-2"></i>Comments</h5>
            <form method="post" action="{% url 'add_comment' post.id %}">
              {% csrf_token %}
              <div class="mb-2">
                <textarea name="comment" class="form-control rounded-3 shadow-sm" rows="2" placeholder="Write your comment..." required></textarea>
              </div>
              <button type="submit" class="btn btn-primary btn-sm rounded-pill px-3">
                <i class="bi bi-chat-dots me-1"></i> Post Comment
              </button>
            </form>
            <div class="mt-3">
              {% if post.comments.all %}
                {% for comment in post.comments.all %}
                  <div class="card border-0 shadow-sm mb-2">
                <div class="card-body p-2 comment-card">
                      <span class="fw-bold text-primary"><i class="bi bi-person-circle me-1"></i>{{ comment.author.username }}</span>
                      <span class="text-muted small ms-2"><i class="bi bi-clock me-1"></i>{{ comment.created_at|date:"M d, Y H:i" }}</span>
                      <div class="mt-1">{{ comment.text }}</div>
                    </div>
                  </div>
                {% endfor %}
              {% else %}
                <div class="text-muted">No comments yet.</div>
              {% endif %}
            </div>
          </section>
          <a href="{% url 'explore' %}" class="btn btn-outline-secondary mt-4 rounded-pill px-4">&#8592; Back to All Posts</a>
        </div>
      </div>
    </div>
  </div>
</div>


{% endblock %}